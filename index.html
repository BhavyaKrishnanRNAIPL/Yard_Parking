<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>VIN Scanner Offline</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 10px;
      background: #f0f0f0;
      color: #333;
    }
    
    .container {
      background: white;
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
    }
    
    h2 {
      color: #2c3e50;
      margin-bottom: 15px;
      text-align: center;
      font-size: 18px;
    }
    
    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    
    input, button, select {
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      font-size: 16px;
      border: 2px solid #ccc;
      border-radius: 4px;
      -webkit-box-sizing: border-box;
      -moz-box-sizing: border-box;
      box-sizing: border-box;
    }
    
    input:focus, select:focus {
      border-color: #3498db;
      outline: none;
    }
    
    button {
      background: #3498db;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    
    .btn-success {
      background: #27ae60;
    }
    
    .btn-danger {
      background: #e74c3c;
    }
    
    .btn-warning {
      background: #f39c12;
    }
    
    .btn-info {
      background: #17a2b8;
    }
    
    .direction-btn {
      width: 48%;
      display: inline-block;
      margin: 2px 1%;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 11px;
    }
    
    th, td {
      border: 1px solid #ddd;
      padding: 4px;
      text-align: center;
    }
    
    th {
      background: #34495e;
      color: white;
    }
    
    .scan-input {
      font-weight: bold;
      font-size: 18px;
      border-color: #27ae60;
    }
    
    .status-info {
      background: #e8f5e8;
      border: 1px solid #27ae60;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      text-align: center;
    }
    
    .delete-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 4px 8px;
      cursor: pointer;
      border-radius: 3px;
      font-size: 10px;
    }
    
    .hidden {
      display: none;
    }
    
    .stats {
      margin: 10px 0;
    }
    
    .stat-item {
      text-align: center;
      padding: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      margin: 5px 0;
    }
    
    .stat-value {
      font-size: 18px;
      font-weight: bold;
      color: #2c3e50;
    }
    
    .stat-label {
      font-size: 12px;
      color: #7f8c8d;
    }

    .message {
      padding: 8px;
      border-radius: 4px;
      margin: 5px 0;
      font-size: 14px;
    }
    
    .error-msg {
      background: #ffebee;
      border: 1px solid #f44336;
      color: #c62828;
    }

    .success-msg {
      background: #e8f5e8;
      border: 1px solid #4caf50;
      color: #2e7d32;
    }

    .current-direction {
      background: #e3f2fd;
      border: 1px solid #2196f3;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      text-align: center;
      font-weight: bold;
    }

    .sub-yard-list {
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid #ccc;
      background: white;
      border-radius: 4px;
    }

    .sub-yard-item {
      padding: 8px;
      cursor: pointer;
      border-bottom: 1px solid #eee;
    }

    .sub-yard-item:hover {
      background: #f5f5f5;
    }

    .sub-yard-item.selected {
      background: #3498db;
      color: white;
    }
  </style>

  <script>
    // Global state variables
    var appState = {
      yardName: "",
      subYardName: "",
      rowName: "",
      currentDirection: "",
      vinCount: 1,
      records: [],
      currentRowRecords: [],
      isScanning: false,
      subYards: []
    };

    var vinInputTimeout;

    // Predefined sub yards list - can be customized
    var predefinedSubYards = [
      "H1", "H2", "H3", "H4", "H5",
      "A1", "A2", "A3", "A4", "A5", 
      "B1", "B2", "B3", "B4", "B5",
      "C1", "C2", "C3", "C4", "C5"
    ];

    // Initialize sub yards dropdown
    function initializeSubYards() {
      var subYardSelect = document.getElementById('subYard');
      subYardSelect.innerHTML = '<option value="">-- Select Sub Yard --</option>';
      
      for (var i = 0; i < predefinedSubYards.length; i++) {
        var option = document.createElement('option');
        option.value = predefinedSubYards[i];
        option.text = predefinedSubYards[i];
        subYardSelect.appendChild(option);
      }
    }

    // Handle VIN input with timeout
    function handleVinInput() {
      var vinInput = document.getElementById('vin');
      if (vinInputTimeout) clearTimeout(vinInputTimeout);
      
      vinInputTimeout = setTimeout(function() {
        var inputValue = vinInput.value.trim().toUpperCase();
        if (inputValue !== "") {
          var extractedVin = extractVIN(inputValue);
          if (extractedVin && validateVIN(extractedVin)) {
            addVinRecord(extractedVin);
            vinInput.value = "";
            showMessage("VIN " + extractedVin + " added successfully", "success");
          } else if (inputValue !== "") {
            showMessage("Invalid VIN format or unable to extract VIN from scanned data", "error");
          }
        }
      }, 300);
    }

    // Extract VIN from scanned data
    function extractVIN(scannedData) {
      try {
        // Pattern: looks for 17 characters after #
        var hashIndex = scannedData.indexOf('#');
        if (hashIndex !== -1 && scannedData.length >= hashIndex + 18) {
          var possibleVin = scannedData.substring(hashIndex + 1, hashIndex + 18);
          if (validateVIN(possibleVin)) {
            return possibleVin.toUpperCase();
          }
        }
        
        // If no # pattern found, check if the input itself is a valid 17-char VIN
        if (scannedData.length === 17 && validateVIN(scannedData)) {
          return scannedData;
        }
        
        // Try to find any 17-character sequence that looks like a VIN
        for (var i = 0; i <= scannedData.length - 17; i++) {
          var possibleVin = scannedData.substring(i, i + 17);
          if (validateVIN(possibleVin)) {
            return possibleVin.toUpperCase();
          }
        }
        
        return null;
      } catch (e) {
        return null;
      }
    }

    // Validate VIN format
    function validateVIN(vin) {
      if (!vin || vin.length !== 17) return false;
      
      // Check for invalid characters (I, O, Q not allowed in VIN)
      var invalidChars = ['I', 'O', 'Q'];
      for (var i = 0; i < invalidChars.length; i++) {
        if (vin.indexOf(invalidChars[i]) !== -1) {
          return false;
        }
      }
      
      // Check if all characters are alphanumeric
      var validChars = 'ABCDEFGHJKLMNPRSTUVWXYZ0123456789';
      for (var i = 0; i < vin.length; i++) {
        if (validChars.indexOf(vin.charAt(i)) === -1) {
          return false;
        }
      }
      
      return true;
    }

    // Switch direction during scanning
    function switchDirection(dir) {
      appState.currentDirection = dir;
      
      var currentDirDisplay = document.getElementById('currentDirectionDisplay');
      var forwardBtn = document.getElementById('scanForwardBtn');
      var reverseBtn = document.getElementById('scanReverseBtn');
      
      currentDirDisplay.innerHTML = 'Current Direction: ' + (dir === 'F' ? 'Forward' : 'Reverse');
      
      // Update button styles
      if (dir === 'F') {
        forwardBtn.style.backgroundColor = '#27ae60';
        reverseBtn.style.backgroundColor = '#3498db';
      } else {
        reverseBtn.style.backgroundColor = '#27ae60';
        forwardBtn.style.backgroundColor = '#3498db';
      }

      showMessage("Switched to " + (dir === 'F' ? 'Forward' : 'Reverse') + " direction", "success");
    }

    // Start scanning process
    function startScanning() {
      var yard = document.getElementById('yard');
      var subYard = document.getElementById('subYard');
      var row = document.getElementById('row');

      appState.yardName = yard.value.trim();
      appState.subYardName = subYard.value.trim();
      appState.rowName = row.value.trim();

      if (!appState.yardName || !appState.subYardName || !appState.rowName) {
        showMessage("Please enter all required fields: Yard, Sub Yard, and Row.", "error");
        return;
      }

      // Disable configuration inputs
      yard.disabled = true;
      subYard.disabled = true;
      row.disabled = true;

      // Reset for new row
      appState.currentRowRecords = [];
      appState.currentDirection = 'F'; // Default to forward
      appState.isScanning = true;

      // Show scanning interface
      var scanSection = document.getElementById('scanSection');
      var vinTable = document.getElementById('vinTable');
      var statsSection = document.getElementById('statsSection');
      
      scanSection.className = "";
      vinTable.className = "";
      statsSection.className = "container";

      // Set default direction
      switchDirection('F');

      updateDisplay();
      updateStatistics();
      
      var vinInput = document.getElementById('vin');
      if (vinInput) {
        vinInput.focus();
      }

      showMessage("Scanning started for Row: " + appState.rowName + ". Default direction: Forward", "success");
    }

    // Add VIN record
    function addVinRecord(vin) {
      var now = new Date();
      var timestamp = formatDateTime(now);

      var record = {
        id: appState.vinCount,
        yard: appState.yardName,
        subYard: appState.subYardName,
        row: appState.rowName,
        bay: 0, // Temporary bay, will be calculated when row is completed
        slot: appState.currentRowRecords.length + 1,
        vin: vin,
        time: timestamp,
        direction: appState.currentDirection,
        isEmpty: false
      };

      appState.currentRowRecords.push(record);
      appState.vinCount++;
      
      rebuildCurrentTable();
      updateDisplay();
      updateStatistics();
      
      var vinInput = document.getElementById('vin');
      if (vinInput) {
        vinInput.focus();
      }
    }

    // Add empty slot
    function addEmptySlot() {
      var now = new Date();
      var timestamp = formatDateTime(now);

      var record = {
        id: appState.vinCount,
        yard: appState.yardName,
        subYard: appState.subYardName,
        row: appState.rowName,
        bay: 0, // Temporary bay, will be calculated when row is completed
        slot: appState.currentRowRecords.length + 1,
        vin: "(Empty)",
        time: timestamp,
        direction: appState.currentDirection,
        isEmpty: true
      };

      appState.currentRowRecords.push(record);
      appState.vinCount++;
      
      rebuildCurrentTable();
      updateDisplay();
      updateStatistics();
      
      var vinInput = document.getElementById('vin');
      if (vinInput) {
        vinInput.focus();
      }

      showMessage("Empty slot marked", "success");
    }

    // Complete current row and calculate bay numbers
    function nextRow() {
      if (appState.currentRowRecords.length === 0) {
        showMessage("No records to complete for this row.", "error");
        return;
      }

      // Calculate bay assignments based on direction logic
      calculateBayAssignments();

      // Add current row records to main records
      for (var i = 0; i < appState.currentRowRecords.length; i++) {
        appState.records.push(appState.currentRowRecords[i]);
      }

      var totalRecords = appState.currentRowRecords.length;
      var minBay = Math.min.apply(Math, appState.currentRowRecords.map(function(r) { return r.bay; }));
      var maxBay = Math.max.apply(Math, appState.currentRowRecords.map(function(r) { return r.bay; }));

      showMessage("Row " + appState.rowName + " completed. Total VINs: " + totalRecords + ", Bay range: " + minBay + " to " + maxBay, "success");

      // Reset for new row
      var yard = document.getElementById('yard');
      var subYard = document.getElementById('subYard');
      var row = document.getElementById('row');
      
      yard.disabled = false;
      subYard.disabled = false;
      row.disabled = false;
      row.value = "";
      
      // Hide scanning section
      document.getElementById('scanSection').className = "hidden";
      
      appState.isScanning = false;
      appState.currentRowRecords = [];
      appState.currentDirection = "";
      
      rebuildMainTable();
      updateStatistics();
      
      row.focus();
    }

    // Calculate bay assignments based on F/R logic
    function calculateBayAssignments() {
      var forwardRecords = [];
      var reverseRecords = [];

      // Separate records by direction
      for (var i = 0; i < appState.currentRowRecords.length; i++) {
        if (appState.currentRowRecords[i].direction === 'F') {
          forwardRecords.push(appState.currentRowRecords[i]);
        } else {
          reverseRecords.push(appState.currentRowRecords[i]);
        }
      }

      var totalRecords = appState.currentRowRecords.length;
      var startBay = 1;

      // Assign bay numbers to forward records (1, 2, 3...)
      for (var i = 0; i < forwardRecords.length; i++) {
        forwardRecords[i].bay = startBay + i;
      }

      // Assign bay numbers to reverse records (from total down to forward end + 1)
      var reverseBay = totalRecords;
      for (var i = 0; i < reverseRecords.length; i++) {
        reverseRecords[i].bay = reverseBay--;
      }
    }

    // Update display elements
    function updateDisplay() {
      var totalScanned = document.getElementById('totalScanned');
      var currentRowCount = document.getElementById('currentRowCount');
      var emptySlots = document.getElementById('emptySlots');
      
      if (totalScanned) totalScanned.innerHTML = appState.records.length + appState.currentRowRecords.length;
      if (currentRowCount) currentRowCount.innerHTML = appState.currentRowRecords.length;
      
      var emptyCount = 0;
      for (var i = 0; i < appState.records.length; i++) {
        if (appState.records[i].isEmpty) {
          emptyCount++;
        }
      }
      for (var i = 0; i < appState.currentRowRecords.length; i++) {
        if (appState.currentRowRecords[i].isEmpty) {
          emptyCount++;
        }
      }
      if (emptySlots) emptySlots.innerHTML = emptyCount;
    }

    // Update statistics
    function updateStatistics() {
      var totalRecords = document.getElementById('totalRecords');
      var vinRecords = document.getElementById('vinRecords');
      var emptyRecords = document.getElementById('emptyRecords');
      
      var allRecords = appState.records.concat(appState.currentRowRecords);
      var total = allRecords.length;
      var vinCount = 0;
      var emptyCount = 0;
      
      for (var i = 0; i < allRecords.length; i++) {
        if (allRecords[i].isEmpty) {
          emptyCount++;
        } else {
          vinCount++;
        }
      }

      if (totalRecords) totalRecords.innerHTML = total;
      if (vinRecords) vinRecords.innerHTML = vinCount;
      if (emptyRecords) emptyRecords.innerHTML = emptyCount;
    }

    // Format date time
    function formatDateTime(date) {
      var year = date.getFullYear();
      var month = date.getMonth() + 1;
      var day = date.getDate();
      var hours = date.getHours();
      var minutes = date.getMinutes();
      var seconds = date.getSeconds();
      
      // Pad with zeros
      if (month < 10) month = '0' + month;
      if (day < 10) day = '0' + day;
      if (hours < 10) hours = '0' + hours;
      if (minutes < 10) minutes = '0' + minutes;
      if (seconds < 10) seconds = '0' + seconds;
      
      return year + '-' + month + '-' + day + ' ' + hours + ':' + minutes + ':' + seconds;
    }

    // Rebuild current row table
    function rebuildCurrentTable() {
      var tableBody = document.getElementById('tableBody');
      if (!tableBody) return;
      
      tableBody.innerHTML = "";
      
      // Show current row records first
      for (var i = 0; i < appState.currentRowRecords.length; i++) {
        var record = appState.currentRowRecords[i];
        var row = document.createElement("tr");
        var isLastRecord = i === appState.currentRowRecords.length - 1;
        var deleteBtn = isLastRecord ?
          '<button class="delete-btn" onclick="deleteCurrentRecord(' + record.id + ')">Delete</button>' : 
          '<span style="color: #bdc3c7;">Locked</span>';
        
        // Color code rows based on content and direction
        if (record.isEmpty) {
          row.style.backgroundColor = "#fff3cd";
        } else if (record.direction === 'R') {
          row.style.backgroundColor = "#ffe6e6";
        }
        
        row.innerHTML = 
          '<td>' + record.id + '</td>' +
          '<td>' + record.yard + '</td>' +
          '<td>' + record.subYard + '</td>' +
          '<td>' + record.row + '</td>' +
          '<td style="color: #999;">TBD</td>' + // Bay to be determined
          '<td>' + record.slot + '</td>' +
          '<td style="font-weight: ' + (record.isEmpty ? 'normal' : 'bold') + '; color: ' + (record.isEmpty ? '#856404' : '#155724') + '">' + record.vin + '</td>' +
          '<td style="font-size: 10px;">' + record.time + '</td>' +
          '<td style="font-size: 10px;">' + record.direction + '</td>' +
          '<td>' + deleteBtn + '</td>';
          
        tableBody.appendChild(row);
      }
    }

    // Rebuild main table with completed rows
    function rebuildMainTable() {
      var tableBody = document.getElementById('tableBody');
      if (!tableBody) return;
      
      tableBody.innerHTML = "";
      
      // Show completed records
      for (var i = 0; i < appState.records.length; i++) {
        var record = appState.records[i];
        var row = document.createElement("tr");
        
        // Color code rows based on content and direction
        if (record.isEmpty) {
          row.style.backgroundColor = "#fff3cd";
        } else if (record.direction === 'R') {
          row.style.backgroundColor = "#ffe6e6";
        }
        
        row.innerHTML = 
          '<td>' + record.id + '</td>' +
          '<td>' + record.yard + '</td>' +
          '<td>' + record.subYard + '</td>' +
          '<td>' + record.row + '</td>' +
          '<td>' + record.bay + '</td>' +
          '<td>' + record.slot + '</td>' +
          '<td style="font-weight: ' + (record.isEmpty ? 'normal' : 'bold') + '; color: ' + (record.isEmpty ? '#856404' : '#155724') + '">' + record.vin + '</td>' +
          '<td style="font-size: 10px;">' + record.time + '</td>' +
          '<td style="font-size: 10px;">' + record.direction + '</td>' +
          '<td><span style="color: #bdc3c7;">Final</span></td>';
          
        tableBody.appendChild(row);
      }

      // Show current row records if scanning
      if (appState.isScanning) {
        rebuildCurrentTable();
      }
      
      var vinTable = document.getElementById('vinTable');
      if (vinTable) {
        if (appState.records.length === 0 && appState.currentRowRecords.length === 0) {
          vinTable.className = "hidden";
        } else {
          vinTable.className = "";
        }
      }
    }

    // Delete current record (only last one)
    function deleteCurrentRecord(id) {
      if (appState.currentRowRecords.length === 0) return;

      var lastRecord = appState.currentRowRecords[appState.currentRowRecords.length - 1];
      if (lastRecord.id !== id) {
        showMessage("Only the most recent record can be deleted.", "error");
        return;
      }

      appState.currentRowRecords.pop();
      appState.vinCount--;

      updateDisplay();
      updateStatistics();
      rebuildCurrentTable();
      
      var vinInput = document.getElementById('vin');
      if (vinInput) {
        vinInput.focus();
      }

      showMessage("Last record deleted successfully", "success");
    }

    // Complete scanning and export
    function completeScanning() {
      if (appState.records.length === 0 && appState.currentRowRecords.length === 0) {
        showMessage("No data to export. Please scan some VINs first.", "error");
        return;
      }

      // If there are current row records, complete them first
      if (appState.currentRowRecords.length > 0) {
        if (confirm("Complete current row before export?")) {
          nextRow();
        }
      }

      // Create CSV content
      var csv = "S.No,Yard,Sub Yard,Row,Bay,Slot,VIN,Timestamp,Direction\n";
      
      for (var i = 0; i < appState.records.length; i++) {
        var record = appState.records[i];
        var vinSafe = record.vin.indexOf(",") !== -1 ? '"' + record.vin + '"' : record.vin;
        csv += record.id + ',' + record.yard + ',' + record.subYard + ',' + record.row + ',' + 
               record.bay + ',' + record.slot + ',' + vinSafe + ',' + record.time + ',' + record.direction + '\n';
      }

      // Download CSV file
      try {
        var blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        var link = document.createElement("a");
        var now = new Date();
        var dateStr = now.getFullYear() + '-' + 
                      (now.getMonth() + 1 < 10 ? '0' : '') + (now.getMonth() + 1) + '-' + 
                      (now.getDate() < 10 ? '0' : '') + now.getDate();
        var fileName = "VIN_Export_" + appState.yardName + "_" + appState.subYardName + "_" + dateStr + "_" + Date.now() + ".csv";

        if (navigator.msSaveBlob) {
          navigator.msSaveBlob(blob, fileName);
        } else if (window.URL && window.URL.createObjectURL) {
          var url = window.URL.createObjectURL(blob);
          link.setAttribute("href", url);
          link.setAttribute("download", fileName);
          link.style.visibility = "hidden";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          window.URL.revokeObjectURL(url);
        }

        showMessage("CSV exported successfully! Records: " + appState.records.length, "success");
      } catch (e) {
        showMessage("Export failed. Browser may not support file download.", "error");
      }
    }

    // Reset everything
    function resetAll() {
      // Reset state
      appState = {
        yardName: "",
        subYardName: "",
        rowName: "",
        currentDirection: "",
        vinCount: 1,
        records: [],
        currentRowRecords: [],
        isScanning: false,
        subYards: []
      };

      // Clear all inputs
      var inputs = ['yard', 'subYard', 'row', 'vin'];
      for (var i = 0; i < inputs.length; i++) {
        var element = document.getElementById(inputs[i]);
        if (element) {
          element.value = "";
          element.disabled = false;
        }
      }

      // Hide all sections
      var sectionsToHide = [
        'scanSection', 
        'vinTable', 
        'statsSection'
      ];
      
      for (var i = 0; i < sectionsToHide.length; i++) {
        var element = document.getElementById(sectionsToHide[i]);
        if (element) {
          if (sectionsToHide[i] === 'statsSection') {
            element.className = "container hidden";
          } else {
            element.className = "hidden";
          }
        }
      }

      // Clear table and messages
      var tableBody = document.getElementById('tableBody');
      if (tableBody) {
        tableBody.innerHTML = "";
      }

      var messageArea = document.getElementById('messageArea');
      if (messageArea) {
        messageArea.innerHTML = "";
      }

      // Reset sub yard dropdown
      initializeSubYards();

      // Reset statistics
      updateStatistics();
      updateDisplay();

      alert("System reset complete. Ready to start again!");
    }

    // Show message function
    function showMessage(message, type) {
      var targetArea = document.getElementById('messageArea');
      
      if (!targetArea) return;

      var className = type === "error" ? "message error-msg" : "message success-msg";
      targetArea.innerHTML = '<div class="' + className + '">' + message + '</div>';

      // Clear message after 5 seconds
      setTimeout(function() {
        if (targetArea) {
          targetArea.innerHTML = "";
        }
      }, 5000);
    }

    // Initialize on page load
    window.onload = function() {
      initializeSubYards();
    };
  </script>
</head>
<body>

<div class="container">
  <h2>VIN Scanner & Allocation System</h2>

  <!-- Yard Configuration -->
  <div>
    <label>Yard Name:</label>
    <input type="text" id="yard" placeholder="e.g., H" />
    
    <label>Sub Yard:</label>
    <select id="subYard">
      <option value="">-- Select Sub Yard --</option>
    </select>
    
    <label>Row Name:</label>
    <input type="text" id="row" placeholder="e.g., 1" />
    
    <button onclick="startScanning()" class="btn-success" id="startScanBtn">Start Scanning</button>
  </div>

  <!-- Scanning Controls -->
  <div id="scanSection" class="container hidden">
    <h3>Scanning Row: <span id="currentRowName"></span></h3>
    
    <!-- Direction Control During Scanning -->
    <div class="current-direction">
      <div id="currentDirectionDisplay">Current Direction: Forward</div>
      <div style="margin-top: 10px;">
        <button type="button" id="scanForwardBtn" class="direction-btn" onclick="switchDirection('F')">F (Forward)</button>
        <button type="button" id="scanReverseBtn" class="direction-btn" onclick="switchDirection('R')">R (Reverse)</button>
      </div>
    </div>

    <div class="status-info">
      <div class="stats">
        <div class="stat-item">
          <div class="stat-value" id="currentRowCount">0</div>
          <div class="stat-label">Current Row VINs</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="totalScanned">0</div>
          <div class="stat-label">Total Scanned</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="emptySlots">0</div>
          <div class="stat-label">Empty Slots</div>
        </div>
      </div
              <!-- VIN Input -->
      <label for="vin">Scan VIN:</label>
      <input type="text" id="vin" class="scan-input" placeholder="Scan or enter VIN" oninput="handleVinInput()" />

      <!-- Action Buttons -->
      <div style="margin-top: 10px;">
        <button onclick="addEmptySlot()" class="btn-warning">Mark Empty Slot</button>
        <button onclick="nextRow()" class="btn-info">Complete Current Row</button>
        <button onclick="completeScanning()" class="btn-success">Export as CSV</button>
        <button onclick="resetAll()" class="btn-danger">Reset All</button>
      </div>
    </div>
  </div>

  <!-- Message Display Area -->
  <div id="messageArea"></div>

  <!-- VIN Table -->
  <div class="container hidden" id="vinTable">
    <h3>VIN Records</h3>
    <table>
      <thead>
        <tr>
          <th>S.No</th>
          <th>Yard</th>
          <th>Sub Yard</th>
          <th>Row</th>
          <th>Bay</th>
          <th>Slot</th>
          <th>VIN</th>
          <th>Timestamp</th>
          <th>Direction</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <!-- Rows will be dynamically added here -->
      </tbody>
    </table>
  </div>

  <!-- Statistics -->
  <div class="container hidden" id="statsSection">
    <h3>Overall Statistics</h3>
    <div class="stats">
      <div class="stat-item">
        <div class="stat-value" id="totalRecords">0</div>
        <div class="stat-label">Total Records</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="vinRecords">0</div>
        <div class="stat-label">VINs Scanned</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="emptyRecords">0</div>
        <div class="stat-label">Empty Slots</div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
